plugins {
    id 'java-library'
    id 'com.flipkart.krystal' version "${krystal_version}"
}

description = 'Enables support for sql in Krystal'

dependencies {
    implementation 'jakarta.inject:jakarta.inject-api'
    implementation 'io.r2dbc:r2dbc-pool:1.0.2.RELEASE'

    /** START: Krystal dependencies **/
    implementation project(':vajram:vajram-java-sdk')
    implementation platform("com.flipkart.krystal:krystal-bom:${krystal_version}")
    annotationProcessor platform("com.flipkart.krystal:krystal-bom:${krystal_version}")
    annotationProcessor 'com.flipkart.krystal:vajram-codegen'

    /** END: Krystal dependencies **/

    /** START: Test dependencies **/
    testImplementation 'io.asyncer:r2dbc-mysql:1.4.1'
    testImplementation 'org.junit.jupiter:junit-jupiter-api'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'
    testImplementation 'org.junit.jupiter:junit-jupiter-params'

    testImplementation platform('org.assertj:assertj-bom:3.25.2')
    testImplementation 'org.assertj:assertj-core'

    testImplementation 'com.flipkart.krystal:vajram-guice'
    testAnnotationProcessor platform("com.flipkart.krystal:krystal-bom:${krystal_version}")
    /** END: Test dependencies **/
}

tasks.withType(Test) {
    testLogging {
        showStandardStreams = true
        // Optionally, ensure the events are also displayed for context
        events "passed", "skipped", "failed"
    }
}