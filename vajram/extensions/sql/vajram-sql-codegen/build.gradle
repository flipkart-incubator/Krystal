plugins {
    id 'java-library'
    id 'com.flipkart.krystal' version "${krystal_version}"
}
description = 'Code generation support for SQL database operations in Krystal'

dependencies {
    implementation project(':krystal-codegen-common')
    implementation project(':vajram:vajram-codegen-common')
    //implementation project(':krystal-common')
    implementation project(':vajram:extensions:sql:vajram-sql')

    implementation project(':vajram:vajram-java-sdk')

    implementation 'com.squareup:javapoet'
    implementation 'io.asyncer:r2dbc-mysql:1.4.1'
    
    // Required for AutoService annotation processor
    compileOnly 'com.google.auto.service:auto-service-annotations:1.1.1'
    annotationProcessor 'com.google.auto.service:auto-service:1.1.1'

    implementation platform("com.flipkart.krystal:krystal-bom:${krystal_version}")
    annotationProcessor platform("com.flipkart.krystal:krystal-bom:${krystal_version}")
    testAnnotationProcessor platform("com.flipkart.krystal:krystal-bom:${krystal_version}")
    annotationProcessor 'com.flipkart.krystal:vajram-codegen'
    compileOnly "org.projectlombok:lombok:$lombok_version"
    compileOnly 'com.google.auto.value:auto-value-annotations:1.11.0'
    compileOnly 'com.google.auto.value:auto-value-annotations:1.11.0'
    annotationProcessor 'com.google.auto.value:auto-value:1.11.0'
    implementation 'com.google.guava:guava:33.4.8-jre'

    /** START: Test dependencies **/
    testImplementation 'org.junit.jupiter:junit-jupiter-api'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'
    testImplementation 'org.junit.jupiter:junit-jupiter-params'

    testImplementation platform('org.assertj:assertj-bom:3.25.2')
    testImplementation 'org.assertj:assertj-core'
    testImplementation 'com.flipkart.krystal:vajram-krystex'
    testImplementation 'com.flipkart.krystal:vajram-guice'
    testImplementation 'com.flipkart.krystal:krystex'

    testImplementation platform('org.mockito:mockito-bom:5.17.0')
    testImplementation 'org.mockito:mockito-core'
    testImplementation 'org.mockito:mockito-junit-jupiter'
    /** END: Test dependencies **/
}

checkerFramework {
    excludeTests = true
}

tasks.withType(Test) {
    testLogging {
        showStandardStreams = true
        events "passed", "skipped", "failed"
    }
}
